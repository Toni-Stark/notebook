<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>可视化-数据中心</title>
    <link rel="stylesheet" href="css/index.css">
    <script src="./js/echarts.min.js"></script>
    <script src="./js/map/guizhou.js"></script>
</head>
<body scroll="no">
<div id="particles-js" class="main">
    <div class="main_con">
        <div class="main-header">
            <div class="header-logo" style="margin-right: 20px"> </div>
            <div class="header-title" style="margin-right: 20px"><span>千港社区管理平台</span></div>
            <div class="header-time" id="header-time">
                &nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp; &nbsp;&nbsp;:&nbsp;&nbsp;:&nbsp;&nbsp;
            </div>
        </div>
        <div class="main-context">
            <div class="main-context-tab-list">
                <div class="tab-list-action">
                    <div class="tab-list-colors">
                        <div class="list-colors-title">过期域名TOP</div>
                        <div class="list-body">
                            <div class="list-colors-list" style="margin-top: 0">
<!--                                <div class="list-colors-item"><div style="width:50%;background:#ab1717"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:20%;background:#ce550b"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:80%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:30%;background:#0bb66f"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:70%;background:#a40ea9"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:56%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:23%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:84%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:48%;background:#50af10"></div><span>阿里云计算有限公司265个</span></div>-->
                            </div>
                        </div>
                    </div>
                    <div class="top" style="width: 20px;height:10px"></div>
                    <div class="right" style="width: 20px;height:10px"></div>
                    <div class="left" style="width: 20px;height:10px"></div>
                    <div class="bottom" style="width: 20px;height:10px"></div>
                </div>
                <div class="content-center" style="margin: 0 20px">
                    <div class="content-tab-main">
                        <div class="content-tab-count">
                            <div class="tab-count" style="border-right-width: 0">
                                3657
                                <div class="top" style="width: 20px;height:10px"></div>
                            </div>
                            <div class="tab-text">主体总数</div>
                        </div>
                        <div class="content-tab-count">
                            <div class="tab-count" style="border-left-width: 0">
                                2645
                                <div class="bottom" style="width: 20px;height:10px"></div>
                            </div>
                            <div class="tab-text">网站总数</div>
                        </div>
                    </div>
                    <div id="mapadd"></div>
                </div>

                <div class="tab-list-action">
                    <div class="tab-list-colors">
                        <div class="list-colors-title">违规站点TOP</div>
                        <div class="list-body">
                            <div class="list-colors-list" style="margin-top: 0">
<!--                                <div class="list-colors-item"><div style="width:50%;background:#ab1717"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:20%;background:#ce550b"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:80%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:30%;background:#0bb66f"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:70%;background:#a40ea9"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:56%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:23%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:84%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>-->
<!--                                <div class="list-colors-item"><div style="width:48%;background:#50af10"></div><span>阿里云计算有限公司265个</span></div>-->
                            </div>
                        </div>
                    </div>
                    <div class="top" style="width: 20px;height:10px"></div>
                    <div class="right" style="width: 20px;height:10px"></div>
                    <div class="left" style="width: 20px;height:10px"></div>
                    <div class="bottom" style="width: 20px;height:10px"></div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
<script src="./js/jquery.min.js"></script>
<script src="./js/request.js"></script>
<script src="./js/create-echarts.js"></script>
<script type="text/javascript">
    function showTime() {
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth() + 1;  //因为month属性从0开始所以加1
        var day = date.getDate();   // 日
        var week = date.getDay();  // 星期几，是个数字
        var hour = date.getHours();
        var minute = date.getMinutes();
        var second = date.getSeconds();
        second = second < 10 ? "0" + second : second;
        var current = year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second;
        document.getElementById("header-time").innerHTML = current;
    }
    setInterval("showTime()", 1000);//每隔1000毫秒（即1秒）显示一次当前时间
</script>
<script type="text/javascript">
    let listColorsTitle = document.getElementsByClassName("list-colors-title");
    var createDom = function ({dom, className, style, text, onClick}) {
        const content = document.createElement(dom);
        content.className = className;
        if (style) {
            content.setAttribute("style", style);
        }
        if (text) {
            content.textContent = text;
        }
        if (onClick) {
            content.addEventListener("click", function (e) {
                return onClick(content)
            })
        }
        return content
    }
    var setDomInHTML = function ({index,title, value, width, color}) {
        var listColors = document.getElementsByClassName("list-colors-list")[index];
        var div1 = createDom({dom:'div', className:'list-colors-item'});
        var div2 = createDom({dom:'div', style:`width:${width};background:${color};`});
        var span1 = createDom({dom:'span', text: title + value + "个"});

        div1.appendChild(div2);
        div1.appendChild(span1);

        listColors.appendChild(div1);
    }
    RequestApi({url: "expired-domain-top", type: "GET", callback: function(res){
        let expired = [];
        if (res.code === 200) {
            for (var i = 0; i < res.data.expire.nums.length; i ++) {
                let item = res.data.expire.provider[i];
                expired.push({
                    title: item.split(':')[0],
                    value: res.data.expire.nums[i]
                })
            }
        }
        let count = getArrayValue(expired);
            listColorsTitle[0].textContent =  listColorsTitle[0].textContent + count;
        for (var j = 0; j < expired.length; j ++) {
            setDomInHTML({index: 0, title: expired[j].title, value: expired[j].value, width: (parseInt(expired[j].value) / count * 100) + "%", color: getArrayColor()})
        }
    }})
    RequestApi({url: "violation-top", type: "GET", callback: function(res){
            let violation = [];
            if (res.code === 200) {
                for (var i = 0; i < res.data.violation.nums.length; i ++) {
                    let item = res.data.violation.provider[i];
                    violation.push({
                        title: item.split(':')[0],
                        value: res.data.violation.nums[i]
                    })
                }
            }
            let count = getArrayValue(violation);
            listColorsTitle[1].textContent =  listColorsTitle[1].textContent + count;
            for (var j = 0; j < violation.length; j ++) {
                setDomInHTML({index: 1, title: violation[j].title, value: violation[j].value, width: (parseInt(violation[j].value) / count * 100) + "%", color: getArrayColor()})
            }
        }})
    RequestApi({url: "stats-api", type: "GET", callback: function(res){
        if (res.code === 200) {
            let tabText = document.getElementsByClassName("tab-count");
            tabText[0].childNodes[0].textContent = res.data.main_count;
            tabText[1].childNodes[0].textContent = res.data.domain_count;
            console.log(tabText[0].childNodes[0])
        }

    }})
</script>
<script type="text/javascript">
    let listColorsList1 = document.getElementsByClassName("list-colors-list")[0];
    let listColorsList2 = document.getElementsByClassName("list-colors-list")[1];

    var createDom = function ({dom, className, style, text, onClick}) {
        const content = document.createElement(dom);
        content.className = className;
        if (style) {
            content.setAttribute("style", style);
        }
        if (text) {
            content.textContent = text;
        }
        if (onClick) {
            content.addEventListener("click", function (e) {
                return onClick(content)
            })
        }
        return content
    }

    var startRotation = function (num, index) {
        var listColors = document.getElementsByClassName("list-colors-list")[index];
        var dom = listColors.children[num];
        var div1 = createDom({dom:'div', className:'list-colors-item'});
        var div2style = dom.querySelector("div").style;
        var div2 = createDom({dom:'div', style:`width:${div2style.width};background:${div2style.background};`});
        var span1 = createDom({dom:'span', text: dom.querySelector("span").textContent});

        div1.appendChild(div2);
        div1.appendChild(span1);

        listColors.appendChild(div1);
    }

    var setIntervalStart = function ({dom, num}) {
        var aList = 0;
        setInterval(function () {
            var marginTop = dom.style.marginTop.split("px")[0];
            dom.style.marginTop = `${parseInt(marginTop) - 1}px`;
            if(Math.abs(parseInt(marginTop)) % 10 === 0) {
                startRotation(aList, num);
                aList ++
            }
        }, 50);
    }
    setTimeout(function (){
        setIntervalStart({dom: listColorsList1, num: 0});
        setIntervalStart({dom: listColorsList2, num: 1});
    }, 200)

</script>