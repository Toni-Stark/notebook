<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>可视化-数据中心</title>
    <link rel="stylesheet" href="./css/index.css">
<!--    <script src="./js/echarts.min.js"></script>-->
<!--    <script src="./js/map/guizhou.js"></script>-->
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=jMl7FS1Kr5TbOZBta3UmYETKqZYWlndw"></script>
</head>
<body scroll="no">
<div id="particles-js" class="main">
    <div class="main_con">
        <div class="main-header">
            <div class="header-logo" style="margin-right: 20px"> </div>
            <div class="header-title" style="margin-right: 20px"><span>白云区公安分部平台</span></div>
            <div class="header-time" id="header-time">
                &nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp; &nbsp;&nbsp;:&nbsp;&nbsp;:&nbsp;&nbsp;
            </div>
        </div>
        <div class="main-context">
            <div class="main-context-tab-list">
                <div class="tab-list-action">
                    <div class="tab-list-colors">
                        <div class="list-colors-title">过期域名TOP</div>
                        <div class="list-body">
                            <div class="list-colors-list" style="margin-top: 0px;transform: translateY(-20px)">
                                <div class="list-colors-item"><div style="width:50%;background:#ab1717"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:20%;background:#ce550b"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:80%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:30%;background:#0bb66f"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:70%;background:#a40ea9"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:56%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:23%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:84%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:48%;background:#50af10"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:70%;background:#a40ea9"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:23%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:80%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:84%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:20%;background:#ce550b"></div><span>阿里云计算有限公司265个</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="top" style="width: 20px;height:10px"></div>
                    <div class="right" style="width: 20px;height:10px"></div>
                    <div class="left" style="width: 20px;height:10px"></div>
                    <div class="bottom" style="width: 20px;height:10px"></div>
                </div>
                <div class="content-center" style="margin: 0 0.2rem;">
                    <div class="content-tab-main">
                        <div class="content-tab-count">
                            <div class="tab-count" style="border-right-width: 0">
                                3657
                                <div class="top" style="width: 20px;height:10px"></div>
                            </div>
                            <div class="tab-text">主体总数</div>
                        </div>
                        <div  class="content-tab-border">
                            <div class="content-tab-right-border"></div>
                        </div>
                        <div class="content-tab-count">
                            <div class="tab-count" style="border-left-width: 0">
                                2645
                                <div class="bottom" style="width: 20px;height:10px"></div>
                            </div>
                            <div class="tab-text">网站总数</div>
                        </div>
                    </div>
                    <div  class="position-map">
                        <div id="mapadd">

                        </div>
                        <div class="map">
                            <div class="transition">
                                <div class="map1"></div>
                                <div class="map2"></div>
                                <div class="map3"></div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="tab-list-action">
                    <div class="tab-list-colors">
                        <div class="list-colors-title">违规站点TOP</div>
                        <div class="list-body">
                            <div class="list-colors-list" style="margin-top: 0px;transform: translateY(-20px)">
                            <div class="list-colors-item"><div style="width:50%;background:#ab1717"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:20%;background:#ce550b"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:80%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:30%;background:#0bb66f"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:70%;background:#a40ea9"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:56%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:23%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:84%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:56%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:48%;background:#50af10"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:80%;background:#bb8407"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:56%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                                <div class="list-colors-item"><div style="width:56%;background:#109b91"></div><span>阿里云计算有限公司265个</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="top" style="width: 20px;height:10px"></div>
                    <div class="right" style="width: 20px;height:10px"></div>
                    <div class="left" style="width: 20px;height:10px"></div>
                    <div class="bottom" style="width: 20px;height:10px"></div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
<script src="./js/jquery.min.js"></script>
<script type="text/javascript">
    function showTime() {
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth() + 1;  //因为month属性从0开始所以加1
        var day = date.getDate();   // 日
        var week = date.getDay();  // 星期几，是个数字
        var hour = date.getHours();
        var minute = date.getMinutes();
        var second = date.getSeconds();
        second = second < 10 ? "0" + second : second;
        document.getElementById("header-time").innerHTML = year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second;
    }
    setInterval("showTime()", 1000);//每隔1000毫秒（即1秒）显示一次当前时间
</script>
<script type="text/javascript">
    let listColorsTitle = document.getElementsByClassName("list-colors-title");
    let listColorsList1 = document.getElementsByClassName("list-colors-list")[0];
    let listColorsList2 = document.getElementsByClassName("list-colors-list")[1];
    var createDom = function (data) {
        const content = document.createElement(data.dom);
        content.className = data.className;
        if (data.style) {
            content.setAttribute("style", data.style);
        }
        if (data.text) {
            content.textContent = data.text;
        }
        if (typeof data.onClick === "function") {
            content.addEventListener("click", function (e) {
                return data.onClick(content)
            })
        }
        return content
    }
    var startRotation = function (index) {
        var listColors = document.getElementsByClassName("list-colors-list")[index];
        var dom = listColors.children[0];
        var div1 = createDom({dom:'div', className:'list-colors-item'});
        var div2style = dom.querySelector("div").style;
        var div2 = createDom({dom:'div', style:'width:' + div2style.width + ';background:' + div2style.background + ';'});
        var span1 = createDom({dom:'span', text: dom.querySelector("span").textContent});

        div1.appendChild(div2);
        div1.appendChild(span1);

        listColors.appendChild(div1);
    }

    var delElement = function (dom) {
        let firstChild = dom.children[0];
        dom.removeChild(firstChild);
    }
    let a = false;
    let margin = '';

    var setIntervalStart = function (data) {
        if (data.dom.children[data.num]) {
            setInterval(function () {
                let ht = document.querySelector("html").style.fontSize.split('px')[0];
                var marginTop = data.dom.style.marginTop.split("px")[0];
                    data.dom.style.marginTop = marginTop - 1 + 'px';
                if (!a) {
                    margin = marginTop - 1;
                }
                if(marginTop != 0 && Math.abs(marginTop) % parseInt(ht*0.5)=== 0) {
                    a = margin === marginTop;
                    data.dom.style.marginTop = Number(marginTop) + parseInt(ht*0.5) + 'px';
                    delElement(data.dom);
                    startRotation(data.num);
                }
            }, 100);
        } else {
            var div = createDom({dom:'div', className:'noneList', text: '没有数据~~', style: "padding: 30px;font-size: .3rem;text-align: center;font-weight: 700;color: white;"});
            data.dom.appendChild(div);
        }
    }
    setIntervalStart({dom: listColorsList1, num: 0});
    setIntervalStart({dom: listColorsList2, num: 1});

    // var setDomInHTML = function ({index,title, value, width, color}) {
    //     var listColors = document.getElementsByClassName("list-colors-list")[index];
    //     var div1 = createDom({dom:'div', className:'list-colors-item'});
    //     var div2 = createDom({dom:'div', style:'width:'+width+';background:' + color+';'});
    //     var span1 = createDom({dom:'span', text: title + value + "个"});
    //
    //     div1.appendChild(div2);
    //     div1.appendChild(span1);
    //     listColors.appendChild(div1);
    // }
    /**
     * 过期域名API;
     */
    // RequestApi({url: "expired-domain-top", type: "GET", callback: function(res){
    //     let expired = [];
    //     if (res.code === 200) {
    //         for (var i = 0; i < res.data.expire.nums.length; i ++) {
    //             let item = res.data.expire.provider[i];
    //             expired.push({
    //                 title: item.split(':')[0],
    //                 value: res.data.expire.nums[i]
    //             })
    //         }
    //     }
    //     let count = getArrayValue(expired);
    //         listColorsTitle[0].textContent =  listColorsTitle[0].textContent + count;
    //     for (var j = 0; j < expired.length; j ++) {
    //         setDomInHTML({index: 0, title: expired[j].title, value: expired[j].value, width: (parseInt(expired[j].value) / count * 100) + "%", color: getArrayColor()})
    //     }
    //     setIntervalStart({dom: listColorsList1, num: 0});
    // }})

    /**
     * 违规站点API;
     */
    // RequestApi({url: "violation-top", type: "GET", callback: function(res){
    //     let violation = [];
    //     if (res.code === 200) {
    //         for (var i = 0; i < res.data.violation.nums.length; i ++) {
    //             let item = res.data.violation.provider[i];
    //             violation.push({
    //                 title: item.split(':')[0],
    //                 value: res.data.violation.nums[i]
    //             })
    //         }
    //     }
    //     let count = getArrayValue(violation);
    //     listColorsTitle[1].textContent =  listColorsTitle[1].textContent + count;
    //     for (var j = 0; j < violation.length; j ++) {
    //         setDomInHTML({index: 1, title: violation[j].title, value: violation[j].value, width: (parseInt(violation[j].value) / count * 100) + "%", color: getArrayColor()})
    //     }
    //     setIntervalStart({dom: listColorsList2, num: 1});
    // }})
    /**
     * 主体总数API;
     */
    // RequestApi({url: "stats-api", type: "GET", callback: function(res){
    //     if (res.code === 200) {
    //         let tabText = document.getElementsByClassName("tab-count");
    //         tabText[0].childNodes[0].textContent = res.data.main_count;
    //         tabText[1].childNodes[0].textContent = res.data.domain_count;
    //     }
    // }})
</script>
<script type="text/javascript">
    /**
     * 地图API 以及生成地图;
     */
    // var data = [];
    // RequestApi({url: "map-data",type:"GET", callback: function(res){
    //         if(res.code === 200) {
    //             for (var i = 0; i < res.data.length; i ++) {
    //                 let result = res.data[i];
    //                 data.push({
    //                     name:result.name.split(':')[0],
    //                     itemStyle: {
    //                         normal: {
    //                             areaColor: '#31398f',
    //                             borderColor: '#35ff9c'
    //                         }
    //                     },
    //                     label: {
    //                         formatter: function (data, type) {
    //                             let info = data.data;
    //                             //这里对不同的内容进行标识 a，b，或者可以随便自己起个别的名字
    //                             return info.name + '：' + info.value + '个';
    //                         },
    //                     },
    //                     value: result.value
    //                 })
    //             }
    //         }
    //         setCanvasMap(data);
    //     }})
    // var setCanvasMap = function (data) {
    //     var myChart = echarts.init(document.getElementById("mapadd"));
    //     option = {
    //         tooltip : {
    //             trigger: 'item',
    //             formatter: '{b}'
    //         },
    //         series : [{
    //             name: '贵州',
    //             type: 'map',
    //             mapType: '贵州',
    //             roam: false,
    //             top:'middle',
    //             zoom:1.2,
    //             // x:'10%',
    //             selectedMode : 'single',
    //             itemStyle:{
    //                 normal:{
    //                     label:{
    //                         show:true,
    //                         textStyle: {
    //                             color: "#ffffff",
    //                             fontSize: 18
    //                         }
    //                     },
    //                     borderColor:'#61c9f3',//区块的边框颜色
    //                     areaColor: '#31398f',
    //                 },
    //                 emphasis:{//鼠标hover样式
    //                     label:{
    //                         show:true,
    //                         textStyle:{
    //                             color:'#ffffff'
    //                         },
    //                     },
    //                     areaColor: '#60c7f2',
    //                 }
    //             },
    //             data: data
    //         }]
    //     };
    //     myChart.setOption(option);
    // }
    // // 地图假数据；
    // setCanvasMap([
    //     {name: '铜仁地区', itemStyle: {normal: {areaColor: '#31398f', borderColor: '#35ff9c'}}, value: 2},
    //     {name: '遵义市', itemStyle: {normal: {areaColor: '#31398f', borderColor: '#35ff9c'}}, value: 2},
    //     {name: '贵阳市', itemStyle: {normal: {areaColor: '#31398f', borderColor: '#35ff9c'}}, value: 2},
    //     {name: '六盘水市', itemStyle: {normal: {areaColor: '#31398f', borderColor: '#35ff9c'}}, value: 2},
    //     {name: '黔东南苗族侗族自治州', itemStyle: {normal: {areaColor: '#31398f', borderColor: '#35ff9c'}}, value: 2}
    // ]);
</script>
<script type="text/javascript">
    var map = new BMapGL.Map("mapadd",{
        enableRotate: false,    // 禁止地图旋转和倾斜可以通过配置项进行设置
        enableTilt: false,      // 禁止地图旋转和倾斜可以通过配置项进行设置
    });
    var mainPoint = new BMapGL.Point(113.34307,23.30290);
    map.centerAndZoom(mainPoint, 12);
    map.setMapStyleV2({
        styleId: 'a6f42e9a956fd60d72ab01e6095b2aaa'
    })
    var starIcon = new BMapGL.Icon("./common/image/star.png", new BMapGL.Size(23,23), {});

    var markerMain = new BMapGL.Marker(mainPoint, {icon: starIcon});
        map.addOverlay(markerMain);
        map.setHeading(0);
        map.setTilt(43);
        map.setZoom(12);        // 再次设置地图级别
    function createPoint (data) {
        var point = new BMapGL.Point(data.longitude,data.latitude);
        var marker = new BMapGL.Marker3D(point, 0, {
            size: 23,
            icon: starIcon
        });
        map.addOverlay(marker);
        if (data.name) {
            var label = new BMapGL.Label(data.name, {
                position: point,
                offset: new BMapGL.Size(0, 15)
            })
            map.addOverlay(label);
            label.setStyle({
                border: '2px solid #1E90FF',
                backgroundColor: 'rgba(69, 109, 255, 0.82)',
                fontSize: '0.12rem',
                color: 'rgb(255, 255, 255)',
                width: '100px',
                borderRadius: '4px',
                textAlign: 'left',
                marginLeft: '-50px'
            })
        }
    }
    function getHealer(){
        var bd1 = new BMapGL.Boundary();
        bd1.get('广州市白云区', function (rs) {
            let count = rs.boundaries.length;
            for (let i = 0; i < count; i++) {
                let path = [];
                let str = rs.boundaries[i].replace(' ', '');
                let points = str.split(';');
                for (let j = 0; j < points.length; j++) {
                    let lng = points[j].split(',')[0];
                    let lat = points[j].split(',')[1];
                    path.push(new BMapGL.Point(lng, lat));
                }
                let prism = new BMapGL.Prism(path, 1000, {
                    topFillColor: 'rgba(65,86,140,0.77)',
                    topFillOpacity: 0.3,
                    sideFillColor: '#112e85',
                    sideFillOpacity: 0.5
                });
                map.addOverlay(prism);

                // 绑定鼠标事件
                var events = ['click', 'mouseover', 'mouseout'];
                for (let i = 0; i < events.length; i++) {
                    prism.addEventListener(events[i], function (e) {
                        switch (events[i]) {
                            case 'mouseover':
                                e.target.setTopFillColor('rgba(126,147,238,0.42)');
                                e.target.setTopFillOpacity(0.2);
                                break;
                            case 'mouseout':
                                e.target.setTopFillColor('rgba(117,143,241,0.66)');
                                e.target.setTopFillOpacity(0.5);
                                break;
                        }
                    });
                }
            }
        });
    };

    var data = [
        {
            "lon": 113.27307,
            "lat": 23.45290,
            "name": "白云市公安"
        },
        {
            "lon": 113.27307,
            "lat": 23.55290,
            "name": "白云市公安"
        },
        {
            "lon": 113.27307,
            "lat": 23.65290,
            "name": "白云市公安"
        }
    ]

    for (let i = 0; i < data.length; i++) {
        createPoint({longitude: data[i].lon, latitude: data[i].lat, name: data[i].name})
    }
    getHealer()
</script>
<script>
    let width = window.screen.width / 1540 * 100;
    let html = document.querySelector("html");
    html.style.fontSize = width + "px";
    let watchWindowSize = function (e) {
        let html = document.querySelector("html");
        let screenWidth = e.currentTarget.screen.width;
        let rem = screenWidth / 1540 * 100;
        html.style.fontSize = rem + "px";
    };

    window.addEventListener("resize", watchWindowSize);
</script>